<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="find a random minecraft server">
    <meta name="keywords" content="mc, minecraft server finder, random mc server, random miencraft server, random minecraft server, bad minecraft servers, good minecraft servers, minecraft smp, mc server, namemc server, minecraft, minecraft server, qazwsxedc1234, Server Finder, Java Server, Bedrock Server, NameMC, Server Info">
    <title>Random Minecraft Servers</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="server-finder.js" defer></script> <!-- External JS for server logic -->
    <style>
        /* Styling similar to previous example */
        :root { 
            --primary-color: #4c4cff; 
            --secondary-color: #6666ff; 
            --background-color: #111;
            --container-bg: rgba(20, 20, 20, 0.9);
            --border-color: #444;
            --input-bg: #222;
            --text-color: #e0e0e0;
            --button-hover-color: #6666ff;
        }

        body, html {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: var(--background-color);
            color: var(--text-color);
            box-sizing: border-box;
        }

        .container {
            background: var(--container-bg);
            padding: 40px;
            border-radius: 16px;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.8);
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--text-color);
        }

        p {
            font-size: 1rem;
            color: var(--text-color);
            margin-bottom: 20px;
        }

        button {
            padding: 14px;
            font-size: 16px;
            width: 100%;
            max-width: 350px;
            margin: 10px 0;
            border-radius: 8px;
            border: none;
            outline: none;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            background: var(--button-hover-color);
            transform: scale(1.05);
            box-shadow: 0 6px 14px rgba(0, 0, 0, 0.5);
        }

        .loading {
            display: none;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .server-info {
            font-size: 1rem;
            color: var(--text-color);
            margin-top: 20px;
            text-align: left;
        }

        .server-info strong {
            font-size: 1.2rem;
            display: block;
            margin-bottom: 10px;
        }

        .error {
            color: red;
            font-size: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Find a Minecraft Server</h1>
    <p>Click "Find Server" to see a recommended server!</p>
    
    <!-- Add platform selection dropdown -->
    <select id="platformSelector">
        <option value="Java">Java</option>
        <option value="Bedrock">Bedrock</option>
        <option value="Bedrock and Java">Both</option>
    </select>

    <button onclick="findServer()">Find Server</button>
    <div id="loadingSpinner" class="loading"></div>
    <p id="errorMessage" class="error"></p>
    <div id="serverDetails" class="server-info"></div>
</div>

<script>
// Declare the servers array only once
const servers = [
    { name: "Hypixel", platform: "Java", ip: "hypixel.net", description: "The Hypixel Network is a Minecraft server containing a variety of minigames, including BedWars, SkyBlock, SMP, SkyWars, Murder Mystery, and more!" },
    { name: "The Hive", platform: "Bedrock", ip: "geo.hivebedrock.network", description: "The Hive Minecraft server, featuring popular mini-games like BedWars, Hide and Seek, and more." },
    { name: "SUNDAY GAMES", platform: "Java", ip: "173.240.154.7", description: "A fun Minecraft server with custom game modes and more!" },
    { name: "Survival 6", platform: "Bedrock and Java", ip: "server.dogcraft.net", description: "A survival server with a focus on community and fun." }
];

// Utility to get user preferences (platform selector)
function getUserPreference() {
    const platformSelector = document.getElementById("platformSelector");
    if (!platformSelector) {
        console.error("Platform selector element not found!");
        return "Java"; // Default to Java if the selector is missing
    }
    return platformSelector.value;
}

// Utility to track server interactions for this session using sessionStorage
function trackServerInteraction(serverName) {
    let interactions = JSON.parse(sessionStorage.getItem("serverInteractions") || "{}");
    interactions[serverName] = (interactions[serverName] || 0) + 1;
    sessionStorage.setItem("serverInteractions", JSON.stringify(interactions));  // Ensure it's stringified
}

// Function to find and display a random server based on user preference and past interactions
function findServer() {
    const loadingSpinner = document.getElementById("loadingSpinner");
    loadingSpinner.style.display = "block";  // Show loading spinner
    const errorMessage = document.getElementById("errorMessage");
    const serverDetails = document.getElementById("serverDetails");

    // Get selected platform
    const userPreference = getUserPreference();

    // Step 1: Get all servers matching user platform (including "Both" servers)
    let availableServers = servers.filter(server => {
        return server.platform === userPreference || server.platform === "Bedrock and Java";
    });

    // Step 2: If no matching server, display an error
    if (availableServers.length === 0) {
        errorMessage.textContent = "No servers available for your selected platform!";
        loadingSpinner.style.display = "none";
        return;
    }

    // Step 3: Consider past interactions (track more interacted servers)
    let interactions = JSON.parse(sessionStorage.getItem("serverInteractions") || "{}");

    // Add interaction scores to servers
    availableServers.forEach(server => {
        server.interactionScore = interactions[server.name] || 0;
    });

    // Step 4: Sort the servers based on interaction score (descending)
    availableServers.sort((a, b) => b.interactionScore - a.interactionScore);

    // Step 5: Pick a random server from the weighted list (prefer more interacted servers)
    let randomIndex = Math.floor(Math.random() * availableServers.length);
    let selectedServer = availableServers[randomIndex];

    // Track the interaction with this server
    trackServerInteraction(selectedServer.name);

    // Step 6: Fetch NameMC stats (simulated here)
    const serverStats = fetchServerStats(selectedServer.ip);  // Simulated fetch for NameMC stats

    // Step 7: Display the selected server's details
    serverDetails.innerHTML = `
        <center><strong>${selectedServer.name}</strong></center>
        <center><p>${selectedServer.description}</p></center>
        <p>IP Address: ${selectedServer.ip}</p>
        <p>Platform: ${selectedServer.platform}</p>
        <p>Interactions: ${selectedServer.interactionScore}</p>
        <p>Stats: ${serverStats}</p>
    `;

    // Hide the loading spinner
    loadingSpinner.style.display = "none";
}

// Simulated function for fetching server stats (e.g., using NameMC API)
function fetchServerStats(ip) {
    // This should be replaced with a real API fetch for server stats
    return `Statistics for server at IP ${ip}`;
}

</script>

</body>
</html>
